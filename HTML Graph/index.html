<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Network Diagram from CSV</title>
    <style>
        #mynetwork {
            width: 100%;
            height: 600px;
            border: 1px solid lightgray;
        }
    </style>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.16.0/d3.min.js"></script>
</head>
<body>
    <h1>Network Diagram from CSV</h1>
    <div id="mynetwork"></div>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Function to parse CSV data
            function parseCSV(csvData) {
                const rows = csvData.split('\n').slice(1); // Skip header row
                const edges = [];
                const nodesSet = new Set();

                rows.forEach(row => {
                    const [source, target] = row.split(',');
                    if (source && target) {
                        edges.push({ from: source.trim(), to: target.trim() });
                        nodesSet.add(source.trim());
                        nodesSet.add(target.trim());
                    }
                });

                const nodes = Array.from(nodesSet).map(node => ({ id: node, label: node }));
                return { nodes, edges };
            }

            // Function to draw the network
            function drawNetwork(data) {
                const container = document.getElementById('mynetwork');
                const nodes = new vis.DataSet(data.nodes);
                const edges = new vis.DataSet(data.edges);
                const networkData = { nodes, edges };
                const options = {};
                new vis.Network(container, networkData, options);
            }

            // Fetch and parse the CSV file, then draw the network
            d3.csv('test.csv').then(data => {
                const parsedData = parseCSV(d3.csvFormat(data));
                drawNetwork(parsedData);
            }).catch(error => {
                console.error('Error loading or parsing CSV file:', error);
            });
        });
    </script>
</body>
</html>
